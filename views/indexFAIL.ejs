<!DOCTYPE html>

<html>
<body>
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <%- include /layouts/header.ejs %>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/index.css">

  <script src="http://code.jquery.com/jquery-2.2.0.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js">
  <script>
    $(document).ready(function(){
        var stock_input;
        var url = 'https://api.iextrading.com/1.0/stock/aapl/chart/1m'
        $.ajax({url:url, dataType:"jsonp"}).then(function(data){
	    console.log(data)
	}
        $("#submit").click(function(){
            stock_input=$("#stock_input").val();
            $.post("http://localhost:5000",{stock_input: stock_input}, function(data){
                if(data==='done')
                {
                    alert("request success");
                }
            });
        });
  </script>
</head>

  <h1>INDEX PAGE</h1>
  <h2><a href="stockSelect"> StockSelect</a> </h2>
  
  <div class="container-fluid">
  	<h3> Your Stocks </h3>
    <div class="row">
        <div class="col-sm-8 pd_none">
            <form>
        		<button type="button" id="btn2" class="btn stock-btn">Load data (AAPL 1d)</button>
        	</form>
        </div>
    </div>
  
  </div>



<script src="http://code.jquery.com/jquery-2.2.0.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js">




<td>Select a stock symbol: </td>
<input type="TEXT" id="stock_input" size="8">
<input type="button" id="submit" value="Submit">

<div class="wrapper">
    <div id="chart"></div>

    <script>
        
        var $company = {}
        var arrHigh = []
        var arrLow = []
        var arrDate = []
        var testurl = 'https://api.iextrading.com/1.0/stock/aapl/chart/1m';

        $.getJSON(url,function(json){
            $.ajax(type: "GET", {url:testurl, dataType:"jsonp"}).then(function(data){
                for(var j = 0; j < 10; j++){
                    arrHigh.push(data[j].high)
                    arrLow.push(data[j].low)
		    arrDate.push(data[j].date)
                }
                var data2 = arrHigh
                console.log(data2)
                Plotly.newPlot('chart', [{
                    z: data2,
                    type: 'surface'
                }]);
            })
        });
</script>
</div>






<form action="/" method="post" name="form1">
    <table width="25%" border="0">
        <tr>

        </tr>
    </table>
</form>

  <script>https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js </script>
  <script type="text/javascript"  src="./routes/index"></script>
</body>
</html>
